(this.webpackJsonpmedicus=this.webpackJsonpmedicus||[]).push([[17],{143:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return y}));var a=n(12),c=n.n(a),r=n(11),i=n(51),s=n(14),o=n(8),d=n(0),l=n(3),m=n(19),u=n(50),j=n(32),p=n(52),b=n(23),h=n(1);function f(e){var t=Object(d.useState)(""),n=Object(o.a)(t,2),a=n[0],i=n[1],l=Object(d.useState)({name:"",dosage:""}),m=Object(o.a)(l,2),u=m[0],f=m[1];function O(e){return x.apply(this,arguments)}function x(){return(x=Object(s.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f(Object(r.a)(Object(r.a)({},u),{},Object(j.a)({},t.target.name,t.target.value)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(){return(g=Object(s.a)(c.a.mark((function t(n){var a,s,o;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.prev=1,a={fromUsername:Object(b.m)({user:e.session}),toUsername:Object(b.m)({user:e.appointment.patient}),name:u.name,dosage:u.dosage},t.next=5,fetch("/api/appointments/".concat(e.appointment.id,"/medications"),{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e.session.authToken)},body:JSON.stringify(a)});case 5:return s=t.sent,t.next=8,s.json();case 8:if(o=t.sent,s.ok){t.next=11;break}throw new Error(o.message);case 11:a.id=o.id,e.appendMedication&&e.appendMedication(a),f(Object(r.a)(Object(r.a)({},u),{},{name:"",dosage:""})),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(1),console.error("Failed to add new medication. ".concat(t.t0)),i(t.t0.message);case 20:case"end":return t.stop()}}),t,null,[[1,16]])})))).apply(this,arguments)}return Object(h.jsxs)(p.a,{className:"container-fluid",handleSubmit:function(e){return g.apply(this,arguments)},children:[a&&Object(h.jsx)(p.f,{className:"justify-content-center",children:Object(h.jsx)("div",{className:"alert alert-danger",role:"alert",children:a})}),Object(h.jsxs)(p.f,{className:"my-2",children:[Object(h.jsx)(p.d,{for:"medicationsForm01",className:"col-sm-4",children:"Name"}),Object(h.jsx)(p.c,{className:"col-sm-8",children:Object(h.jsx)("input",{id:"medicationsForm01",name:"name",type:"text",className:"form-control",value:u.name,onChange:O,placeholder:"Name of Medication"})})]}),Object(h.jsxs)(p.f,{className:"my-2",children:[Object(h.jsx)(p.d,{for:"medicationsForm02",className:"col-sm-4",children:"Dosage (in mg)"}),Object(h.jsx)(p.c,{className:"col-sm-8",children:Object(h.jsx)("input",{id:"medicationsForm02",name:"dosage",type:"text",className:"form-control",value:u.dosage,onChange:O,placeholder:"Dosage (in mg)"})})]}),Object(h.jsx)(p.f,{className:"my-2 justify-content-center",children:Object(h.jsx)(p.g,{className:"btn-primary col-auto col-md-4",children:"Add"})})]})}var O=n(13);function x(e){return Object(h.jsx)(u.l,{children:Object(h.jsx)(O.e,{children:Object(h.jsx)(O.g,{children:Object(h.jsx)(O.a,{className:"md-font-sm text-center text-muted",children:"No medication available"})})})})}function g(e){function t(){return(t=Object(s.a)(c.a.mark((function t(n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault(),e.handleDelete&&e.handleDelete(e.medication.id);case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var n=e.medication.fromUsername,a=Object(b.m)({user:e.session})===n;return Object(h.jsx)(u.l,{children:Object(h.jsx)(O.e,{children:Object(h.jsxs)(O.g,{children:[Object(h.jsx)(O.a,{className:"align-self-center",children:Object(h.jsxs)(O.g,{children:[Object(h.jsx)(O.a,{className:"text-truncate",children:e.medication.name}),Object(h.jsx)(O.a,{className:"col-auto",children:"".concat(e.medication.dosage," mg")})]})}),Object(h.jsx)(O.a,{className:"col-auto px-2",children:a&&Object(h.jsx)(u.i,{children:Object(h.jsx)(u.j,{handleClick:function(e){return t.apply(this,arguments)},children:"Delete"})})})]})})})}function v(e){return Object(h.jsx)(u.k,{children:0!==e.medications.length?Object(h.jsx)(h.Fragment,{children:e.medications.map((function(t,n){return Object(h.jsx)(g,{session:e.session,medication:t,handleDelete:e.deleteMedication},n)}))}):Object(h.jsx)(x,{})})}function y(e){var t=Object(d.useState)({medications:[],limit:10}),n=Object(o.a)(t,2),a=n[0],j=n[1];function p(){return(p=Object(s.a)(c.a.mark((function t(){var n,s,o,d;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n="/api/appointments/".concat(e.appointment.id,"/medications"),(s=new URLSearchParams).append("page",Math.ceil(a.medications.length/a.limit)),s.append("limit",a.limit),t.next=7,fetch("".concat(n,"?").concat(s.toString()),{headers:{Authorization:"Bearer ".concat(e.session.authToken)}});case 7:return o=t.sent,t.next=10,o.json();case 10:if(d=t.sent,o.ok){t.next=13;break}throw new Error(d.message);case 13:j((function(e){var t=[].concat(Object(i.a)(e.medications),Object(i.a)(d));return Object(r.a)(Object(r.a)({},e),{},{medications:t})})),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),console.error("Failed to append more medications. ".concat(t.t0));case 19:case"end":return t.stop()}}),t,null,[[0,16]])})))).apply(this,arguments)}function b(){return(b=Object(s.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j((function(e){var n=[t].concat(Object(i.a)(e.medications));return Object(r.a)(Object(r.a)({},e),{},{medications:n})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return(O=Object(s.a)(c.a.mark((function t(n){var i,s;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("/api/appointments/".concat(e.appointment.id,"/medications/").concat(n),{method:"DELETE",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e.session.authToken)}});case 3:return i=t.sent,t.next=6,i.json();case 6:if(s=t.sent,i.ok){t.next=9;break}throw new Error(s.message);case 9:j((function(e){var t=a.medications.filter((function(e){return e.id!==n}));return Object(r.a)(Object(r.a)({},e),{},{medications:t})})),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),console.error("Failed to delete medication- ".concat(n,". ").concat(t.t0));case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))).apply(this,arguments)}var x=Object(l.a)(e.session,e.appointment.physician);return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)(u.e,{children:[Object(h.jsx)(u.a,{title:"Medications",children:x&&Object(h.jsx)(u.d,{target:"apptMedicationAdd01",expandIcon:"add",collapseIcon:"clear"})}),Object(h.jsx)(u.g,{id:"apptMedicationAdd01",children:Object(h.jsx)(f,{session:e.session,appointment:e.appointment,appendMedication:function(e){return b.apply(this,arguments)}})}),Object(h.jsx)(v,{session:e.session,medications:a.medications,deleteMedication:function(e){return O.apply(this,arguments)}})]}),Object(h.jsx)(m.a,{callback:function(){return p.apply(this,arguments)}})]})}},51:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(25);var c=n(20);function r(e){return function(e){if(Array.isArray(e))return Object(a.a)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(c.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}}}]);
//# sourceMappingURL=17.21579d0c.chunk.js.map